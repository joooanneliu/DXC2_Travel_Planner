<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Options</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Navigation bar -->
    {% include 'navbar.html' %}
    <div class="container">
        <h1>Hotel Options</h1>

        <!-- Sort Dropdown (optional) -->
        <div class="sort-container">
            <label for="sort-options">Sort by:</label>
            <select id="sort-options" name="sort-options" onchange="sortHotels(this.value)">
                <option value="price-asc">Price - Ascending</option>
                <option value="price-desc">Price - Descending</option>
                <option value="rating-asc">Rating - Ascending</option>
                <option value="rating-desc">Rating - Descending</option>
            </select>
        </div>

        <!-- Display hotels -->
        <form action="{{ url_for('itinerary') }}" method="POST">
            <div class="hotel-list" id="hotel-list">
                {% for hotel in hotels %}
                <div class="hotel-option" data-rating="{{ hotel.overall_rating }}" data-price="{{ hotel.rate_per_night.lowest if hotel.rate_per_night else 'Infinity' }}">
                    <input type="radio" id="hotel-{{ loop.index }}" name="hotel" value="{{ hotel.name }}" required>
                    <label for="hotel-{{ loop.index }}" class="hotel-label">
                        <div class="hotel-content">
                            <img src="{{ hotel.images[0].thumbnail }}" alt="{{ hotel.name }}" class="hotel-image">
                            <div class="hotel-info">
                                <strong>{{ hotel.name }}</strong>
                                <span>Price per night: {{ hotel.rate_per_night.lowest if hotel.rate_per_night else 'N/A' }}</span>
                                <span>Rating: {{ hotel.overall_rating }} / 5</span>
                                <span>Class: {{ hotel.hotel_class }}</span>
                            </div>
                        </div>
                    </label>
                </div>
                {% else %}
                <p>No hotels available</p>
                {% endfor %}
            </div>
            <button type="submit" id="confirm2">Next</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Get the default value from the sort dropdown
            const defaultSort = document.getElementById('sort-options').value;
            sortFlights(defaultSort);
        });

    function sortFlights(criteria) {
        const flightList = document.getElementById('flight-list');
        const flights = Array.from(flightList.getElementsByClassName('flight-option'));

        // Sorting logic
        flights.sort((a, b) => {
            const priceA = parseFloat(a.getAttribute('data-price')) || Infinity; // Default to Infinity if price missing
            const priceB = parseFloat(b.getAttribute('data-price')) || Infinity;
            const timeA = Date.parse(a.getAttribute('data-time')) || 0; // Default to 0 if time missing
            const timeB = Date.parse(b.getAttribute('data-time')) || 0;

            if (criteria === 'price-asc') return priceA - priceB;
            if (criteria === 'price-desc') return priceB - priceA;
            if (criteria === 'time-asc') return timeA - timeB;
            if (criteria === 'time-desc') return timeB - timeA;
        });

        // Reorder flights in the DOM
        flights.forEach(flight => flightList.appendChild(flight));
    }

    </script>
</body>
</html>
